<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script>
        function setButtonTimeout(buttonId, timeoutMs) {
            const button = document.getElementById(buttonId);
            let timeout;

            button.addEventListener('click', function() {
                button.disabled = true;
                button.textContent = "Processing...";
                timeout = setTimeout(() => {
                    alert("The request is taking too long. Please try again.");
                    button.disabled = false;
                    button.textContent = "Submit";
                }, timeoutMs);
            });

            document.querySelector('form').addEventListener('submit', function() {
                clearTimeout(timeout);
            });
        }

        window.onload = function() {
            setButtonTimeout('submit-answer-btn', 30000);  // 30 seconds timeout
        };
    </script>
</head>
<body>
    <h1>Quiz</h1>
    {% if question %}
        <form method="POST">
            <p>{{ question }}</p>
            {% for option, text in options.items() %}
                <input type="radio" id="{{ option }}" name="user_answer" value="{{ text }}">
                <label for="{{ option }}">{{ option }}: {{ text }}</label><br>
            {% endfor %}
            <input type="hidden" name="correct_answer" value="{{ correct_answer }}">
            <input type="hidden" name="question" value="{{ question }}">
            <button type="submit" id="submit-answer-btn">Submit Answer</button>
        </form>
        {% if feedback %}
            <p>{{ feedback }}</p>
            <form method="POST" action="/reset_quiz">
                <button type="submit">Try Another Question</button>
            </form>
        {% endif %}
    {% else %}
        <p>Loading question...</p>
    {% endif %}
</body>
</html>
